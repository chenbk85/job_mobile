<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_32) on Tue Nov 27 09:40:42 CET 2012 -->
<TITLE>
StreamOut (apache-cassandra API)
</TITLE>

<META NAME="date" CONTENT="2012-11-27">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="StreamOut (apache-cassandra API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StreamOut.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/apache/cassandra/streaming/StreamInSession.html" title="class in org.apache.cassandra.streaming"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/apache/cassandra/streaming/StreamOut.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StreamOut.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.apache.cassandra.streaming</FONT>
<BR>
Class StreamOut</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.apache.cassandra.streaming.StreamOut</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>StreamOut</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class handles streaming data from one node to another.

 The source node [the Out side] is always in charge of the streaming session.  Streams may
 be initiated either directly by the source via the methods in this class,
 or on demand from the target (via StreamRequest).

 Files to stream are grouped into sessions, which can have callbacks associated
 with them so that (for instance) we can mark a new node a full member of the
 cluster after all the data it needs has been streamed.

 The source begins a session by sending
 a Message with the stream bit flag in the Header turned on.  Part of that Message
 will include a StreamHeader that includes the files that will be streamed as part
 of that session, as well as the first file-to-be-streamed. (Combining session list
 and first file like this is inconvenient, but not as inconvenient as the old
 three-part send-file-list, wait-for-ack, start-first-file dance.)

 This is done over a separate TCP connection to avoid blocking ordinary intra-node
 traffic during the stream.  So there is no Handler for the main stream of data --
 when a connection sets the Stream bit, IncomingTcpConnection knows what to expect
 without any further Messages.

 After each file, the target node [the In side] will send a StreamReply indicating success
 (FILE_FINISHED) or failure (FILE_RETRY).

 When all files have been successfully transferred and integrated the target will
 send an additional SESSION_FINISHED reply and the session is complete.

 For Stream requests (for bootstrap), one subtlety is that we always have to
 create at least one stream reply, even if the list of files is empty, otherwise the
 target has no way to know that it can stop waiting for an answer.
<P>

<P>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/apache/cassandra/streaming/StreamOut.html#StreamOut()">StreamOut</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/apache/cassandra/streaming/StreamOut.html#transferRanges(java.net.InetAddress, org.apache.cassandra.db.Table, java.util.Collection, org.apache.cassandra.streaming.IStreamCallback, org.apache.cassandra.streaming.OperationType)">transferRanges</A></B>(java.net.InetAddress&nbsp;target,
               <A HREF="../../../../org/apache/cassandra/db/Table.html" title="class in org.apache.cassandra.db">Table</A>&nbsp;table,
               java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
               <A HREF="../../../../org/apache/cassandra/streaming/IStreamCallback.html" title="interface in org.apache.cassandra.streaming">IStreamCallback</A>&nbsp;callback,
               <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stream the given ranges to the target endpoint from each CF in the given keyspace.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/apache/cassandra/streaming/StreamOut.html#transferRanges(org.apache.cassandra.streaming.StreamOutSession, java.lang.Iterable, java.util.Collection, org.apache.cassandra.streaming.OperationType)">transferRanges</A></B>(<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming">StreamOutSession</A>&nbsp;session,
               java.lang.Iterable&lt;<A HREF="../../../../org/apache/cassandra/db/ColumnFamilyStore.html" title="class in org.apache.cassandra.db">ColumnFamilyStore</A>&gt;&nbsp;cfses,
               java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
               <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stream the given ranges to the target endpoint from each of the given CFs.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/apache/cassandra/streaming/StreamOut.html#transferSSTables(org.apache.cassandra.streaming.StreamOutSession, java.lang.Iterable, java.util.Collection, org.apache.cassandra.streaming.OperationType)">transferSSTables</A></B>(<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming">StreamOutSession</A>&nbsp;session,
                 java.lang.Iterable&lt;<A HREF="../../../../org/apache/cassandra/io/sstable/SSTableReader.html" title="class in org.apache.cassandra.io.sstable">SSTableReader</A>&gt;&nbsp;sstables,
                 java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
                 <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Low-level transfer of matching portions of a group of sstables from a single table to the target endpoint.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="StreamOut()"><!-- --></A><H3>
StreamOut</H3>
<PRE>
public <B>StreamOut</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="transferRanges(java.net.InetAddress, org.apache.cassandra.db.Table, java.util.Collection, org.apache.cassandra.streaming.IStreamCallback, org.apache.cassandra.streaming.OperationType)"><!-- --></A><H3>
transferRanges</H3>
<PRE>
public static void <B>transferRanges</B>(java.net.InetAddress&nbsp;target,
                                  <A HREF="../../../../org/apache/cassandra/db/Table.html" title="class in org.apache.cassandra.db">Table</A>&nbsp;table,
                                  java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
                                  <A HREF="../../../../org/apache/cassandra/streaming/IStreamCallback.html" title="interface in org.apache.cassandra.streaming">IStreamCallback</A>&nbsp;callback,
                                  <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)</PRE>
<DL>
<DD>Stream the given ranges to the target endpoint from each CF in the given keyspace.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="transferRanges(org.apache.cassandra.streaming.StreamOutSession, java.lang.Iterable, java.util.Collection, org.apache.cassandra.streaming.OperationType)"><!-- --></A><H3>
transferRanges</H3>
<PRE>
public static void <B>transferRanges</B>(<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming">StreamOutSession</A>&nbsp;session,
                                  java.lang.Iterable&lt;<A HREF="../../../../org/apache/cassandra/db/ColumnFamilyStore.html" title="class in org.apache.cassandra.db">ColumnFamilyStore</A>&gt;&nbsp;cfses,
                                  java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
                                  <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)</PRE>
<DL>
<DD>Stream the given ranges to the target endpoint from each of the given CFs.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="transferSSTables(org.apache.cassandra.streaming.StreamOutSession, java.lang.Iterable, java.util.Collection, org.apache.cassandra.streaming.OperationType)"><!-- --></A><H3>
transferSSTables</H3>
<PRE>
public static void <B>transferSSTables</B>(<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming">StreamOutSession</A>&nbsp;session,
                                    java.lang.Iterable&lt;<A HREF="../../../../org/apache/cassandra/io/sstable/SSTableReader.html" title="class in org.apache.cassandra.io.sstable">SSTableReader</A>&gt;&nbsp;sstables,
                                    java.util.Collection&lt;<A HREF="../../../../org/apache/cassandra/dht/Range.html" title="class in org.apache.cassandra.dht">Range</A>&lt;<A HREF="../../../../org/apache/cassandra/dht/Token.html" title="class in org.apache.cassandra.dht">Token</A>&gt;&gt;&nbsp;ranges,
                                    <A HREF="../../../../org/apache/cassandra/streaming/OperationType.html" title="enum in org.apache.cassandra.streaming">OperationType</A>&nbsp;type)
                             throws java.io.IOException</PRE>
<DL>
<DD>Low-level transfer of matching portions of a group of sstables from a single table to the target endpoint.
 You should probably call transferRanges instead. This moreover assumes that references have been acquired on the sstables.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StreamOut.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/apache/cassandra/streaming/StreamInSession.html" title="class in org.apache.cassandra.streaming"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/apache/cassandra/streaming/StreamOutSession.html" title="class in org.apache.cassandra.streaming"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/apache/cassandra/streaming/StreamOut.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StreamOut.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &copy; 2012 The Apache Software Foundation
</BODY>
</HTML>
